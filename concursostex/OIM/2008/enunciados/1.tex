Se distribuyeron los números $1,2,3, \cdots 2008^2$ en un tablero $2008 \times 2008$, de modo que en cada casilla haya un número distinto. Para cada fila y cada columna del tablero se calcula la diferencia entre el mayor y el menor de sus elementos. Sea $S$ la suma de los $4016$ números obtenidos. Determine el mayor valor posible de $S$.
