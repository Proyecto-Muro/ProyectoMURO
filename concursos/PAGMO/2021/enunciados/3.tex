Sea $\mathbb R$ el conjunto de los números reales. Determine todas las funciones $f: \mathbb R \to \mathbb R$ tales que la igualdad
\[f(x+yf(x+y))+xf(x)=f(xf(x+y+1))+y^2\]
es verdadera para cualesquiera números reales $x,y$.